---
layout : post
title : Ustage Day 9
subtitle : Pandas(2)|í™•ë¥ ë¡  ë§›ë³´ê¸°
tags : [BoostCamp AI Tech]
author : Heeseok Jeong
comments : True
use_math: True
sitemap :
  changefreq : daily
  priority : 1.0
---

# ëª©ì°¨

<br>

- [Pandas(2)](#pandas-2-)
- [í™•ë¥ ë¡  ë§›ë³´ê¸°](#í™•ë¥ ë¡ -ë§›ë³´ê¸°)
- [í”¼ì–´ ì„¸ì…˜](#í”¼ì–´-ì„¸ì…˜)
- [Today I Felt](#today-i-felt)

<br>

<hr>

<br>

# Pandas(2)

<br>

## Groupby

- SQL groupby ëª…ë ¹ì–´ì™€ ê°™ìŒ
- split â†’ apply â†’ combine

    ![image1]({{ site.baseurl }}/assets/img/ustage_day9/1.png)

- ë¬¸ë²•
    - df.groupby("Team")['Point'].sum()
    - df ë°ì´í„°ì—ì„œ íŒ€ë³„ë¡œ ì ìˆ˜ë¥¼ í•©ì‚°í•´ì„œ êµ¬ë¶„í•´ë¼.

```python
import pandas as pd
ipl_data = {'Team': ['Riders', 'Riders', 'Devils', 'Devils', 'Kings',
         'kings', 'Kings', 'Kings', 'Riders', 'Royals', 'Royals', 'Riders'],
         'Rank': [1, 2, 2, 3, 3,4 ,1 ,1,2 , 4,1,2],
         'Year': [2014,2015,2014,2015,2014,2015,2016,2017,2016,2014,2015,2017],
         'Points':[876,789,863,673,741,812,756,788,694,701,804,690]}

df = pd.DataFrame(ipl_data)
df
'''
Team	Rank	Year	Points
0	Riders	1	2014	876
1	Riders	2	2015	789
2	Devils	2	2014	863
3	Devils	3	2015	673
4	Kings	3	2014	741
5	kings	4	2015	812
6	Kings	1	2016	756
7	Kings	1	2017	788
8	Riders	2	2016	694
9	Royals	4	2014	701
10	Royals	1	2015	804
11	Riders	2	2017	690
'''

df.groupby("Team")["Points"].sum()
'''
Team
Devils    1536
Kings     2285
Riders    3049
Royals    1505
kings      812
Name: Points, dtype: int64
'''

df = df.groupby(["Team", "Year"])["Points"].sum()
df
'''
Team    Year
Devils  2014    863
        2015    673
Kings   2014    741
        2016    756
        2017    788
Riders  2014    876
        2015    789
        2016    694
        2017    690
Royals  2014    701
        2015    804
kings   2015    812
Name: Points, dtype: int64
'''
```

- ì—‘ì…€ì˜ í”¼ë²—í…Œì´ë¸”ë¡œë„ í•  ìˆ˜ ìˆìŒ

### Hierarchical index

- ì—¬ëŸ¬ ì¸ë±ìŠ¤ë¥¼ ë°ì´í„°í”„ë ˆì„ ì¡°íšŒì— ë„£ì–´ì„œ í•´ë‹¹ ì¸ë±ìŠ¤ë“¤ ê¸°ì¤€ìœ¼ë¡œ ë³´ëŠ” ë°©ë²•
- ìœ„ ê·¸ë£¹ë°”ì´ ë§ˆì§€ë§‰ ì˜ˆì‹œë„ ë§ˆì°¬ê°€ì§€
- unstack() : ì‹œë¦¬ì¦ˆëŠ” ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ, ë°ì´í„°í”„ë ˆì„ì€ ì‹œë¦¬ì¦ˆë¡œ ëŒë ¤ì¤Œ
- reset_index() : ë‹¤ë¥¸ ì¸ë±ìŠ¤ë¡œ êµ¬ì„±ëœ ì‹œë¦¬ì¦ˆë‚˜ ë°ì´í„°í”„ë ˆì„ì„ ê¸°ë³¸ì¸ë±ìŠ¤ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ëŒë ¤ì¤Œ

```python
df2 = df.unstack()
df2

'''
Year	2014	2015	2016	2017
Team				
Devils	863.0	673.0	NaN	NaN
Kings	741.0	NaN	756.0	788.0
Riders	876.0	789.0	694.0	690.0
Royals	701.0	804.0	NaN	NaN
kings	NaN	812.0	NaN	NaN
'''

df3 = df.reset_index()
df3
'''
Team	Year	Points
0	Devils	2014	863
1	Devils	2015	673
2	Kings	2014	741
3	Kings	2016	756
4	Kings	2017	788
5	Riders	2014	876
6	Riders	2015	789
7	Riders	2016	694
8	Riders	2017	690
9	Royals	2014	701
10	Royals	2015	804
11	kings	2015	812
'''
```

- swap_level() : ì¸ë±ìŠ¤ ìˆœì„œ(ê³„ì¸µ) ë¥¼ ë°”ê¿”ì¤Œ
- sort_index() : ì¸ë±ìŠ¤ ê¸°ì¤€ ì •ë ¬
- sort_values() : ê°’ ê¸°ì¤€ ì •ë ¬

### grouped

- ê·¸ë£¹ë°”ì´ì— ì˜í•´ ìŠ¤í”Œë¦¿ëœ ìƒíƒœ ì¶”ì¶œ
- íŠœí”Œë¡œ í‚¤, ë°¸ë¥˜ê°€ ì—®ì—¬ì„œ ë‚˜ì˜´
- ë”°ë¡œ í•¨ìˆ˜ëŠ” ì•„ë‹ˆê³  groupby ë¡œ ë‚˜ì˜¨ ì œë„ˆë ˆì´í„° í™œìš©í•˜ëŠ” ë°©ë²•ì„
- íƒ€ì…ì€ pd.DataFrame.Groupby

```python
grouped = df.groupby("Team")
for gr in grouped:
    print(gr)
'''
('Devils', Team    Year
Devils  2014    863
        2015    673
Name: Points, dtype: int64)
('Kings', Team   Year
Kings  2014    741
       2016    756
       2017    788
Name: Points, dtype: int64)
('Riders', Team    Year
Riders  2014    876
        2015    789
        2016    694
        2017    690
Name: Points, dtype: int64)
('Royals', Team    Year
Royals  2014    701
        2015    804
Name: Points, dtype: int64)
('kings', Team   Year
kings  2015    812
Name: Points, dtype: int64)
'''

for name, group in grouped:
    print(name)
    print(group)
'''
Devils
Team    Year
Devils  2014    863
        2015    673
Name: Points, dtype: int64
Kings
Team   Year
Kings  2014    741
       2016    756
       2017    788
Name: Points, dtype: int64
Riders
Team    Year
Riders  2014    876
        2015    789
        2016    694
        2017    690
Name: Points, dtype: int64
Royals
Team    Year
Royals  2014    701
        2015    804
Name: Points, dtype: int64
kings
Team   Year
kings  2015    812
Name: Points, dtype: int64
'''
```

- grouped.get_group() : íŠ¹ì • ê·¸ë£¹ ê°€ì ¸ì˜´

```python
grouped.get_group("Kings")
'''
Team   Year
Kings  2014    741
       2016    756
       2017    788
Name: Points, dtype: int64
'''
```

- grouped ëœ ìƒíƒœëŠ” ì„¸ ê°€ì§€ ìœ í˜•ì˜ apply ê°€ëŠ¥
    - Aggregation : ìš”ì•½ëœ í†µê³„ì •ë³´ ì¶”ì¶œ

```python
grouped.agg(sum)
'''
Team
Devils    1536
Kings     2285
Riders    3049
Royals    1505
kings      812
Name: Points, dtype: int64
'''

# ì—¬ëŸ¬ ê°œë„ ê°€ëŠ¥
grouped.agg([sum, np.mean, max])
'''
sum	mean	max
Team			
Devils	1536	768.000000	863
Kings	2285	761.666667	788
Riders	3049	762.250000	876
Royals	1505	752.500000	804
kings	812	812.000000	812
'''
```

- Transformation : group ëœ ë°ì´í„°ì—ì„œ í•´ë‹¹ í•¨ìˆ˜ëŒ€ë¡œ ëª¨ë“  í–‰ì— ì ìš©, ê·¸ë£¹ ë³„ ì—°ì‚°ì—ì„œ ê°ê°ì˜ ê°’ì— ì˜í–¥ ì£¼ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©

```python
score = lambda x: (x - x.mean()) / x.std()
grouped.transform(score)'
'''
Rank	Year	Points
0	-1.500000	-1.161895	1.284327
1	0.500000	-0.387298	0.302029
2	-0.707107	-0.707107	0.707107
3	0.707107	0.707107	-0.707107
4	1.154701	-1.091089	-0.860862
5	NaN	NaN	NaN
6	-0.577350	0.218218	-0.236043
7	-0.577350	0.872872	1.096905
8	0.500000	0.387298	-0.770596
9	0.707107	-0.707107	-0.707107
10	-0.707107	0.707107	0.707107
11	0.500000	1.161895	-0.815759
'''
```

- Filteration : íŠ¹ì • ì •ë³´ ì œê±°í•´ì„œ ë³´ì—¬ì£¼ëŠ” í•„í„°ê¸°ëŠ¥

```python
df.groupby('Team').filter(lambda x: x["Points"].max() > 800)
'''
Team	Rank	Year	Points
0	Riders	1	2014	876
1	Riders	2	2015	789
2	Devils	2	2014	863
3	Devils	3	2015	673
5	kings	4	2015	812
8	Riders	2	2016	694
9	Royals	4	2014	701
10	Royals	1	2015	804
11	Riders	2	2017	690
'''
```

## ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ë°”ê¾¸ê¸°

- apply ì‚¬ìš©

```python
import dateutil

df_phone = pd.read_csv("./data/phone_data.csv")
df_phone.head()
'''
index	date	duration	item	month	network	network_type
0	0	15/10/14 06:58	34.429	data	2014-11	data	data
1	1	15/10/14 06:58	13.000	call	2014-11	Vodafone	mobile
2	2	15/10/14 14:46	23.000	call	2014-11	Meteor	mobile
3	3	15/10/14 14:48	4.000	call	2014-11	Tesco	mobile
4	4	15/10/14 17:27	4.000	call	2014-11	Tesco	mobile
'''

df_phone["date"] = df_phone["date"].apply(dateutil.parser.parse, dayfirst=True)
df_phone.dtypes
'''
index                    int64
date            datetime64[ns]
duration               float64
item                    object
month                   object
network                 object
network_type            object
dtype: object
'''
```

## plot

- matplotlib ì„¤ì¹˜
    - !conda install - - y matplotlib
- DF ë‚˜ ì‹œë¦¬ì¦ˆ ë’¤ì— .plot() í•´ì£¼ë©´ ê·¸ë¦¼ ë‚˜ì˜´, ë”°ë¡œ ì„í¬íŠ¸ ì•ˆí•´ë„ ë¨

## Pivot Table

- ì—‘ì…€ì˜ ê¸°ëŠ¥ê³¼ ê°™ìŒ
- index ì¶•ì€ groupby ì™€ ë™ì¼
- column ì— ì¶”ê°€ë¡œ ë¼ë²¨ë§ ê°’ ì¶”ê°€í•˜ì—¬ value ì— numeric íƒ€ì… ê°’ì„ aggregation í•˜ëŠ” í˜•íƒœ

```python
df_phone.pivot_table(
    values=["duration"],
    index=[df_phone.month, df_phone.item],
    columns=df_phone.network,
    aggfunc="sum",
    fill_value=0,
)
'''
duration
network	Meteor	Tesco	Three	Vodafone	data	landline	special	voicemail	world
month	item									
2014-11	call	1521	4045	12458	4316	0.000	2906	0	301	0
data	0	0	0	0	998.441	0	0	0	0
sms	10	3	25	55	0.000	0	1	0	0
2014-12	call	2010	1819	6316	1302	0.000	1424	0	690	0
data	0	0	0	0	1032.870	0	0	0	0
sms	12	1	13	18	0.000	0	0	0	4
2015-01	call	2207	2904	6445	3626	0.000	1603	0	285	0
data	0	0	0	0	1067.299	0	0	0	0
sms	10	3	33	40	0.000	0	0	0	0
2015-02	call	1188	4087	6279	1864	0.000	730	0	268	0
data	0	0	0	0	1067.299	0	0	0	0
sms	1	2	11	23	0.000	0	2	0	0
2015-03	call	274	973	4966	3513	0.000	11770	0	231	0
data	0	0	0	0	998.441	0	0	0	0
sms	0	4	5	13	0.000	0	0	0	3
'''

# groupby ë¡œ êµ¬í˜„
df_phone.groupby(["month", "item", "network"])["duration"].sum().unstack()
'''
network	Meteor	Tesco	Three	Vodafone	data	landline	special	voicemail	world
month	item									
2014-11	call	1521.0	4045.0	12458.0	4316.0	NaN	2906.0	NaN	301.0	NaN
data	NaN	NaN	NaN	NaN	998.441	NaN	NaN	NaN	NaN
sms	10.0	3.0	25.0	55.0	NaN	NaN	1.0	NaN	NaN
2014-12	call	2010.0	1819.0	6316.0	1302.0	NaN	1424.0	NaN	690.0	NaN
data	NaN	NaN	NaN	NaN	1032.870	NaN	NaN	NaN	NaN
sms	12.0	1.0	13.0	18.0	NaN	NaN	NaN	NaN	4.0
2015-01	call	2207.0	2904.0	6445.0	3626.0	NaN	1603.0	NaN	285.0	NaN
data	NaN	NaN	NaN	NaN	1067.299	NaN	NaN	NaN	NaN
sms	10.0	3.0	33.0	40.0	NaN	NaN	NaN	NaN	NaN
2015-02	call	1188.0	4087.0	6279.0	1864.0	NaN	730.0	NaN	268.0	NaN
data	NaN	NaN	NaN	NaN	1067.299	NaN	NaN	NaN	NaN
sms	1.0	2.0	11.0	23.0	NaN	NaN	2.0	NaN	NaN
2015-03	call	274.0	973.0	4966.0	3513.0	NaN	11770.0	NaN	231.0	NaN
data	NaN	NaN	NaN	NaN	998.441	NaN	NaN	NaN	NaN
sms	NaN	4.0	5.0	13.0	NaN	NaN	NaN	NaN	3.0
'''
```

## Crosstab

- í”¼ë²—í…Œì´ë¸”ê³¼ ê±°ì˜ ë™ì¼
- ë„¤íŠ¸ì›Œí¬ ë°ì´í„° (a ì™€ b ê°€ ìƒê´€ ìˆìŒ) ì— ì‚¬ìš©í•˜ë©´ í¸í•¨
- ì¸ë±ìŠ¤, ì»¬ëŸ¼, ë²¨ë¥˜, ì–´ê·¸ë¦¬ê²Œì´ì…˜ ì„¸íŒ… í•˜ë©´ë¨

â†’ groupby, pivot_table, crosstab ë‹¤ ê°€ëŠ¥

## merge & concat

### merge (join ê³¼ ê°™ìŒ)

- sql ì—ì„œ ë§ì´ ì‚¬ìš©í•˜ëŠ” merge ì™€ ê°™ì€ ê¸°ëŠ¥
- ë‘ ê°œì˜ í…Œì´ë¸”ì„ í•˜ë‚˜ë¡œ í•©ì¹¨
- ê¸°ì¤€ì´ ìˆì–´ì•¼í•¨
- pd.merge(df_a, df_b, on='subject_id') # ë‘ í…Œì´ë¸”ì„ subject_id ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•©ì¹¨
- ë‘ í…Œì´ë¸”ì—ì„œ ì»¬ëŸ¼ëª…ì´ ë‹¤ë¥¼ ë•ŒëŠ” left_on ê³¼ right_on ë”°ë¡œ ì ì–´ì£¼ë©´ ë¨
- join method
    - inner join : ê²¹ì¹˜ëŠ” ë‚´ìš©ë§Œ ë³´ì—¬ì¤Œ
    - full join : ëª¨ë“  ë‚´ìš© ë‹¤ í•©ì³ì„œ ë³´ì—¬ì¤Œ
    - left join : ì™¼ìª½ ëª¨ë“  ë‚´ìš© + ì˜¤ë¥¸ìª½ ê²¹ì¹˜ëŠ” ë‚´ìš© ë³´ì—¬ì¤Œ
    - right join : left join ë°˜ëŒ€
    - ì—†ëŠ” ê°’ì€ NaN ìœ¼ë¡œ ì±„ì›Œì§
    - merge(~~, how="inner") ë¡œ ì ì–´ì£¼ë©´ ë¨, ê¸°ë³¸ì€ inner

### concat

- ì»¬ëŸ¼ì„ ë” ë„“íˆëŠ”ê²Œ ì•„ë‹ˆë¼ ë°ì´í„° ì–‘ì„ ë” ë„“í˜ (ì„¸ë¡œë¡œ) â†’ ê°™ì€ ì»¬ëŸ¼ì„ ê°–ê³  ìˆì–´ì•¼í•¨
- axis=1 í•˜ë©´ ì˜†ìœ¼ë¡œ ë¶™ìŒ
- pd.concat([df_a, df_b])

â†’ ì—¬ëŸ¬ ì—‘ì…€ íŒŒì¼ë“¤ í•©ì¹˜ê³  í•„ìš”í•œ ì •ë³´ ë½‘ì„ ë•Œ ë°°ìš´ groupby merge concat ë“±ë“± ì“°ë©´ ìœ ìš©

## Persistance

### DB ì—°ê²°

#### sqlite3

- ë¡œì»¬ ë””ë¹„
- import sqlite3 í•´ì„œ ì¨ë„ ë¨
- ì›ê²© ë˜ëŠ” mysql ë“± ì¨ë„ ë¨

### ì—‘ì…€ ì‘ì„±ê¸°

- !conda install â€”y XlsxWriter
    - df_routes ì‚¬ìš©ê°€ëŠ¥
- writer = pd.ExcelWriter(...) ì“°ê³  df_routes.to_excel(writer, sheet_name="my_data") í•˜ë©´ ì‘ì„±ê°€ëŠ¥
- df_routes.to_pickle ê°€ëŠ¥

<br>

<hr>

<br>

# í™•ë¥ ë¡  ë§›ë³´ê¸°

<br>

## ë”¥ëŸ¬ë‹ì—ì„œ í™•ë¥ ë¡ ì´ í•„ìš”í•œ ì´ìœ 

- ë”¥ëŸ¬ë‹ì€ í™•ë¥ ë¡  ê¸°ë°˜ì˜ ê¸°ê³„í•™ìŠµ ì´ë¡ ì— ê¸°ë°˜í•¨
- ì†ì‹¤í•¨ìˆ˜ (loss function) ë“¤ì˜ ì‘ë™ ì›ë¦¬ëŠ” ë°ì´í„° ê³µê°„ì„ í†µê³„ì ìœ¼ë¡œ í•´ì„í•´ì„œ ìœ ë„í•¨
    - ì˜ˆì¸¡ì´ í‹€ë¦´ ìœ„í—˜ (risk) ë¥¼ ìµœì†Œí™”í•˜ë„ë¡ ë°ì´í„°ë¥¼ í•™ìŠµ â†’ SGD
- íšŒê·€ ë¶„ì„ì—ì„œ ì†ì‹¤í•¨ìˆ˜ë¡œ ì‚¬ìš©ë˜ëŠ” L2-norm ì€ **ì˜ˆì¸¡ì˜¤ì°¨ì˜ ë¶„ì‚°**ì„ ê°€ì¥ ìµœì†Œí™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í•™ìŠµí•˜ë„ë¡ ìœ ë„
- ë¶„ë¥˜ ë¬¸ì œì—ì„œ ì‚¬ìš©ë˜ëŠ” êµì°¨ì—”íŠ¸ë¡œí”¼ (cross-entropy) ëŠ” ëª¨ë¸ **ì˜ˆì¸¡ì˜ ë¶ˆí™•ì‹¤ì„±**ì„ ìµœì†Œí™”í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ í•™ìŠµ
- ë¶„ì‚° ë° ë¶ˆí™•ì‹¤ì„±ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´ì„œëŠ” ì¸¡ì •í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ì•¼ í•¨
    - ë‘ ëŒ€ìƒì„ ì¸¡ì •í•˜ëŠ” ë°©ë²•ì€ í†µê³„í•™ ê¸°ë°˜ì´ë¯€ë¡œ í™•ë¥ ë¡ ì„ ì•Œì•„ì•¼ í•¨

## í™•ë¥ ë¶„í¬ëŠ” ë°ì´í„°ì˜ ì´ˆìƒí™”

- í…Œì´í„° ê³µê°„ì„ $x$ x $y$ ë¼ í‘œê¸°í•˜ê³  ğ”‡ ëŠ” ë°ì´í„°ê³µê°„ì—ì„œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ëŠ” ë¶„í¬
- ë°ì´í„°ëŠ” í™•ë¥ ë³€ìˆ˜ë¡œ ($x$, $y$) ~ ğ”‡ ë¼ í‘œê¸°
    - í™•ë¥ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ë¡œ í‘œì‹œ, ì„ì˜ë¡œ ë°ì´í„° ê³µê°„ì—ì„œ ê´€ì¸¡ëœ ë°ì´í„°ë¥¼ í™•ë¥ ë³€ìˆ˜ë¡œ ë°ì´í„° ì¶”ì¶œ
    - ì¶”ì¶œí•œ ë°ì´í„°ì˜ ë¶„í¬ â†’ ğ”‡
- ê²°í•©ë¶„í¬ P(x, y) ëŠ” ğ”‡ ë¥¼ ëª¨ë¸ë§
    - ê²°í•©ë¶„í¬ëŠ” ì›ë˜ í™•ë¥ ë¶„í¬ íƒ€ì…ì— ìƒê´€ì—†ì´ ì´ì‚°í˜•ì´ë‚˜ ì—°ì†í˜• ê°€ëŠ¥
    - ê²°í•©ë¶„í¬ëŠ” ì•„ê·œë¨¼íŠ¸ë¡œ ì“°ì¸ í™•ë¥ ë³€ìˆ˜ë“¤ì„ ê°™ì´ ê³ ë ¤í•œë‹¤ëŠ” ëœ»
- P(x) ëŠ” ì…ë ¥ x ì— ëŒ€í•œ ì£¼ë³€í™•ë¥ ë¶„í¬ë¡œ y ì— ëŒ€í•œ ì •ë³´ë¥¼ ì£¼ì§€ ì•ŠìŒ
    - ì£¼ë³€í™•ë¥ ë¶„í¬ P(x) ëŠ” ê²°í•©ë¶„í¬ P(x, y) ë¥¼ y ì— ëŒ€í•´ ë”í•˜ê±°ë‚˜ ì ë¶„í•´ì„œ ìœ ë„
- ì¡°ê±´ë¶€í™•ë¥ ë¶„í¬ P(x|y) ëŠ” ë°ì´í„° ê³µê°„ì—ì„œ ì…ë ¥ x ì™€ ì¶œë ¥ y ì‚¬ì´ì˜ ê´€ê³„ë¥¼ ëª¨ë¸ë§
    - P(X | Y = 1) : Y ê°€ 1 ì¼ ë•Œ X ì˜ í™•ë¥ ë¶„í¬
    - ì›ë”œë‹˜ ì„¤ëª… : ì „ì²´ ê³µê°„ S ëŒ€ì‹  Y ê³µê°„ì—ì„œ X ì˜ í™•ë¥ ë¶„í¬
    - ê²°í•©ë¶„í¬ë§ê³  ì¡°ê±´ë¶€í™•ë¥ ë¶„í¬ë¥¼ ì“°ë©´ ë°ì´í„° ê°ê°ì— ëŒ€í•´ ë” ëª…í™•í•˜ê²Œ ì•Œì•„ë‚¼ ìˆ˜ ìˆìŒ
- í™•ë¥ ë¶„í¬ëŠ” ë°ì´í„°ë¥¼ í•´ì„í•˜ëŠ”ë° ë„ì›€ì„ ì¤Œ (ì´ˆìƒí™”)

![image2]({{ site.baseurl }}/assets/img/ustage_day9/2.png)

### ì´ì‚°í™•ë¥ ë³€ìˆ˜ vs ì—°ì†í™•ë¥ ë³€ìˆ˜

- í™•ë¥ ë³€ìˆ˜ëŠ” í™•ë¥ ë¶„í¬ ğ”‡ ì— ë”°ë¼ ì´ì‚°í˜• (discrete) ê³¼ ì—°ì†í˜• (continuous) í™•ë¥ ë³€ìˆ˜ë¡œ êµ¬ë¶„
    - ë°ì´í„° ê³µê°„ $x$ x $y$ ë¡œ êµ¬ë¶„í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ í™•ë¥ ë¶„í¬ì˜ ì¢…ë¥˜ì— ë”°ë¼ êµ¬ë¶„!
- ì´ì‚°í˜•í™•ë¥ ë³€ìˆ˜
    - í™•ë¥ ë³€ìˆ˜ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ê²½ìš°ì˜ ìˆ˜ë¥¼ ëª¨ë‘ ê³ ë ¤í•˜ì—¬ í™•ë¥ ì„ **ë”í•´ì„œ** ëª¨ë¸ë§í•¨
    - P(X = x) ëŠ” í™•ë¥ ë³€ìˆ˜ê°€ x ê°’ì„ ê°€ì§ˆ í™•ë¥ 

    ![image3]({{ site.baseurl }}/assets/img/ustage_day9/3.png)

- ì—°ì†í˜•í™•ë¥ ë³€ìˆ˜
    - ë°ì´í„° ê³µê°„ì— ì •ì˜ëœ í™•ë¥ ë³€ìˆ˜ì˜ ë°€ë„ (density) ìœ„ì—ì„œì˜ **ì ë¶„**ì„ í†µí•´ ëª¨ë¸ë§
    - P(x) : ë°€ë„í•¨ìˆ˜, ëˆ„ì í™•ë¥ ë¶„í¬, ë°ì´í„° ê³µê°„ì— ì •ì˜ëœ í™•ë¥ ë³´ë‹¤ëŠ” ë°€ë„ (ì ë¶„ í•„ìš”)
        - ë°€ë„ëŠ” ëˆ„ì í™•ë¥ ë¶„í¬ì˜ ë³€í™”ìœ¨ì„ ëª¨ë¸ë§, í™•ë¥ ë¡œ í•´ì„ x
    - ë³´í†µ ì»´í“¨í„°ì— ì“°ëŠ” ë°ì´í„°ëŠ” ì´ì‚°í˜•ì´ì§€ë§Œ ê¸°ê³„í•™ìŠµì—ëŠ” ì •ê·œë¶„í¬, ê°ë§ˆë¶„í¬ ë“± ì—°ì†í˜•í™•ë¥ ë³€ìˆ˜ ì”€

    ![image4]({{ site.baseurl }}/assets/img/ustage_day9/4.png)

- ì´ì‚°í˜•ê³¼ ì—°ì†í˜•ìœ¼ë¡œ ëª¨ë“  í™•ë¥ ë¶„í¬ í‘œí˜„ë˜ëŠ”ê±´ ì•„ë‹˜, ë” ìˆìŒ

### ì¡°ê±´ë¶€í™•ë¥ ê³¼ ê¸°ê³„í•™ìŠµ

- ì¡°ê±´ë¶€í™•ë¥  P(y | x) ëŠ” ì…ë ¥ë³€ìˆ˜ x ì— ëŒ€í•´ ì •ë‹µì´ y ì¼ í™•ë¥ 
    - ì—°ì†í™•ë¥ ë¶„í¬ë©´ í™•ë¥  ëŒ€ì‹  ë°€ë„ë¡œ í•´ì„
- ì €ë²ˆ ì‹œê°„ì— ì‚¬ìš©í•œ ë¡œì§€ìŠ¤í‹± íšŒê·€ì˜ ì„ í˜•ëª¨ë¸ê³¼ ì†Œí”„íŠ¸ë§¥ìŠ¤ í•¨ìˆ˜ì˜ ê²°í•©ì€ **ë°ì´í„°ì—ì„œ ì¶”ì¶œëœ íŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ í™•ë¥  í•´ì„**
    - ì„ í˜•í•¨ìˆ˜ê°€ ë¹„ì„ í˜•í•¨ìˆ˜ë¥¼ ê±°ì¹˜ë©´ í™•ë¥ ì´ ë¨
- ë¶„ë¥˜ ë¬¸ì œì—ì„œ softmax($W\phi + b)$ ëŠ” ë°ì´í„° x ë¡œë¶€í„° ì¶”ì¶œëœ íŠ¹ì§•íŒ¨í„´ $\phi(x)$ ê³¼ ê°€ì¤‘ì¹˜í–‰ë ¬ W ì„ í†µí•´ ì¡°ê±´ë¶€ í™•ë¥  P(y | x) (= P(y | $\phi(x)$) ë¥¼ ê³„ì‚°
- íšŒê·€ ë¬¸ì œì˜ ê²½ìš° ì¡°ê±´ë¶€ê¸°ëŒ€ê°’ E[y | x] ë¥¼ ì¶”ì •
    - ì¡°ê±´ë¶€ í™•ë¥  ëŒ€ì‹  ì¡°ê±´ë¶€ê¸°ëŒ€ê°’ì„ êµ¬í•´ì•¼(ì¶”ì •)í•œë‹¤ëŠ” ë§
    - ë³´í†µ íšŒê·€ ë¬¸ì œëŠ” ì—°ì†í™•ë¥ ë¶„í¬ë¥¼ ë‹¤ë£¨ë¯€ë¡œ ì ë¶„ ì‚¬ìš©
    - ì™œ ì¡°ê±´ë¶€ê¸°ëŒ€ê°’ì„ êµ¬í•˜ë‚˜?
        - ëª©ì ì‹ L2-norm ì„ ìµœì†Œí™”í•˜ëŠ” í•¨ìˆ˜ = ì¡°ê±´ë¶€ê¸°ëŒ€ê°’ ì´ê¸° ë•Œë¬¸
    - robust (ê°•ê±´) í•˜ê²Œ ì˜ˆì¸¡í•  ë•ŒëŠ” ì¡°ê±´ë¶€ê¸°ëŒ€ê°’ ëŒ€ì‹  median (ì¤‘ê°„ê°’) ì‚¬ìš©
    - í†µê³„ì  ëª¨í˜•ì—ì„œ ì›í•˜ëŠ” ëª©ì ì— ë”°ë¼ ì¶”ì •ëŸ‰ì´ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤!

    ![image5]({{ site.baseurl }}/assets/img/ustage_day9/5.png)

- ë”¥ëŸ¬ë‹ì€ ë‹¤ì¸µì‹ ê²½ë§ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¡œë¶€í„° íŠ¹ì§•íŒ¨í„´ $\phi$ ë¥¼ ì¶”ì¶œ
    - íŠ¹ì§•íŒ¨í„´ì„ í•™ìŠµí•˜ê¸° ìœ„í•´ ì–´ë–¤ ì†ì‹¤í•¨ìˆ˜ë¥¼ ì‚¬ìš©í• ì§€ëŠ” ê¸°ê³„í•™ìŠµ ë¬¸ì œì™€ ëª¨ë¸ì— ì˜í•´ ê²°ì •ë¨

### ê¸°ëŒ€ê°’

- í™•ë¥ ë¶„í¬ê°€ ì£¼ì–´ì§€ë©´ ë°ì´í„°ë¥¼ ë¶„ì„í•˜ëŠ”ë° ì‚¬ìš© ê°€ëŠ¥í•œ ì—¬ëŸ¬ ì¢…ë¥˜ì˜ í†µê³„ì  ë²”í•¨ìˆ˜ (statistical function) ê³„ì‚° ê°€ëŠ¥
- ê¸°ëŒ€ê°’ (expectation) ì€ **ë°ì´í„°ë¥¼ ëŒ€í‘œí•˜ëŠ” í†µê³„ëŸ‰**ì´ë©´ì„œ ë™ì‹œì— **í™•ë¥ ë¶„í¬ë¥¼ í†µí•´ ë‹¤ë¥¸ í†µê³„ì  ë²”í•¨ìˆ˜ë¥¼ ê³„ì‚°**í•˜ëŠ”ë° ì‚¬ìš©

![image6]({{ site.baseurl }}/assets/img/ustage_day9/6.png)

- ê¸°ëŒ€ê°’ì„ ì´ìš©í•´ ë¶„ì‚°, ì²¨ë„(ì²¨ë„ë§ê³  ì™œë„ì¸ë“¯ = ë¹„ëŒ€ì¹­ë„), ê³µë¶„ì‚° ë“± ì—¬ëŸ¬ í†µê³„ëŸ‰ ê³„ì‚° ê°€ëŠ¥

![image7]({{ site.baseurl }}/assets/img/ustage_day9/7.png)

- ê¸°ì–µí•´ì•¼í•  ê²ƒ : ì´ì‚°ì´ë©´ ê¸‰ìˆ˜(ì§ˆëŸ‰í•¨ìˆ˜), ì—°ì†ì´ë©´ ì ë¶„ ì‚¬ìš©

### ëª¬í…Œì¹´ë¥¼ë¡œ ìƒ˜í”Œë§

- ê¸°ê³„í•™ìŠµì˜ ë§ì€ ë¬¸ì œë“¤ì€ í™•ë¥ ë¶„í¬ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ëª¨ë¥¼ ë•Œê°€ ëŒ€ë¶€ë¶„ â†’ ê¸°ê³„í•™ìŠµì—ì„œ ë§¤ìš° ë‹¤ì–‘í•˜ê²Œ ì‘ìš©
- í™•ë¥ ë¶„í¬ë¥¼ ëª¨ë¥´ê¸°ì— ë°ì´í„°ë¥¼ ì´ìš©í•´ ê¸°ëŒ€ê°’ì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ ëª¬í…Œì¹´ë¥¼ë¡œ ìƒ˜í”Œë§ì„ ì‚¬ìš©
- ì´ì‚°í˜• ì—°ì†í˜• ìƒê´€ì—†ì´ ì„±ë¦½
- ë…ë¦½ì¶”ì¶œ (ë¶„í¬ì—ì„œ ë…ë¦½ì ìœ¼ë¡œ ì¶”ì¶œ = ìƒ˜í”Œë§) ì´ ë³´ì¥ëœë‹¤ë©´ ëŒ€ìˆ˜ì˜ ë²•ì¹™ (law of large number) ì— ì˜í•´ ìˆ˜ë ´ì„±ì„ ë³´ì¥
(Q. ëŒ€ìˆ˜ì˜ ë²•ì¹™ì´ ë­ì§€ -> ì „ì²´ ëª¨ì§‘ë‹¨ì—ì„œ ëœë¤í•œ í‘œë³¸ì˜ í‰ê· ì€ ì „ì²´ì˜ í‰ê· ê³¼ ê°€ê¹Œìš¸ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ëŠ” ë²•ì¹™)

    ![image8]({{ site.baseurl }}/assets/img/ustage_day9/8.png)

- ì˜ˆì œ : ì ë¶„ ê³„ì‚°í•˜ê¸°
    - í™•ë¥ ë¶„í¬ê°€ ì•„ë‹Œ ê³µê°„ì—ì„œ ì ë¶„ì€ ë¶ˆê°€ëŠ¥ â†’ ëª¬í…Œì¹´ë¥¼ë¡œ
    - ì˜ˆì œì˜ f(x) ëŠ” ìš°ë¦¬ê°€ ì•„ëŠ” ì ë¶„ì‹ìœ¼ë¡œ ì ë¶„ êµ¬í•˜ê¸° í˜ë“¦
    - f(x) ì˜ ì ë¶„ì˜ ê¸¸ì´ê°€ 2 ì´ë¯€ë¡œ ë°˜ìœ¼ë¡œ ë‚˜ëˆ„ë©´ ê¸°ëŒ€ê°’. ê¸°ëŒ€ê°’ì€ ëª¬í…Œì¹´ë¥¼ë¡œ ë°©ë²• ê°€ëŠ¥.
    - ë‹¤ êµ¬í•˜ê³  ë‹¤ì‹œ 2 ê³±í•˜ë©´ ë¨.
    - ì˜¤ì°¨ê°€ ì¡°ê¸ˆ ìˆìŒ, ë”°ë¼ì„œ uniform (ê· ë“±) ë¶„í¬ì—ì„œ ìƒ˜í”Œë§í•´ì£¼ë©´ ì˜¤ì°¨ ë²”ìœ„ ì•ˆì— ë“¤ì–´ì˜´.
        - ìƒ˜í”Œ ì‚¬ì´ì¦ˆê°€ ì ìœ¼ë©´ ì˜¤ì°¨ë²”ìœ„ ì»¤ì§ â†’ ì°¸ê°’ì— ë©€ì–´ì§, ì ì ˆíˆ ì¡°ì ˆí•´ì•¼ í•¨

    ![image9]({{ site.baseurl }}/assets/img/ustage_day9/9.png)

    ![image10]({{ site.baseurl }}/assets/img/ustage_day9/10.png)

### **Further Question**

<br>

<hr>

<br>

# í”¼ì–´ ì„¸ì…˜

<br>

## í”¼ì–´ ì„¸ì…˜ì´ í”¼ì–´ì”ë‹ˆë‹¤

- ê°ì˜¤ : ìš°ë¦¬ ë‚˜ì´ì— ëŠ¦ì€ê±´ í‚¤ì¦ˆ ëª¨ë¸ë¿! ì´ˆì‹¬ê³¼ ë§¥ì‹¬ì„ ìƒì§€ ë§ì^^

## ìˆ˜ì—… ì§ˆë¬¸

- iid = ì„œë¡œ ë…ë¦½ì´ê³  ë™ì¼í•œ ë¶„í¬ë¥¼ ë”°ë¥¸ë‹¤. ~ ë¬¼ê²° í‘œì‹œë¡œ í‘œí˜„. ì´ê²Œ ë¼ì•¼ ëª¬í…Œì¹´ë¥¼ë¡œ ìƒ˜í”Œë§ ê°€ëŠ¥ (ì „ì œì¡°ê±´ì„)
- í™•ë¥  ë°°ìš°ê³  ì´ëŸ°ê±° ì‹¤ì œë¡œ ë§ì´ ì“°ì¼ê¹Œ? â†’ ë…¼ë¬¸ ë³¼ ë•Œ ìˆ˜ì‹ ì—„ì²­ ë‚˜ì™€ì„œ ëª¨ë¥´ë©´ ì´í•´ê°€ ì•ˆë¨
- í­ê·„ë‹˜ ë¸”ë¡œê¹… íŒ : ì•„ì›ƒë¼ì¸ ë¨¼ì € ë§‰ ì ì–´ë†“ê³  ì •ë¦¬ë¥¼ í•´ë‚˜ê°
- ì„œí¿ë‹˜ : ìˆ˜ì‹ì„ ì¸ì‹í•´ì„œ ë¼í…ìŠ¤ ë¬¸ë²•ìœ¼ë¡œ ë°”ê¿”ì£¼ëŠ” í”„ë¡œì íŠ¸ í•´ë³´ê³  ì‹¶ë‹¤ (OCR) â†’ ì— ì œì´ë‹˜ : mask RCNN ë…¼ë¬¸ ì½ì–´ë³´ëŠ”ê±° ì¶”ì²œ

<br>

<hr>

<br>

# Today I Felt

<br>

## ì¡°í™”

2 ì£¼ì°¨ëŠ” ë¨¸ì‹ ëŸ¬ë‹ì— í•„ìš”í•œ ìˆ˜í•™ì— ëŒ€í•´ ê³µë¶€í•˜ê³  ìˆë‹¤. ìˆ˜í•™ì— ê´€ë ¨ë˜ë‹¤ë³´ë‹ˆ ìš”ì¦˜ í”¼ì–´ì„¸ì…˜ì—ì„œ ê°€ì¥ ë‘ë“œëŸ¬ì§€ëŠ” ì‚¬ëŒì€ ì›ë”œë‹˜ì´ë‹¤ (í†µê³„ê°“,,) . í†µê³„ì— ëŒ€í•œ ê¸°ë³¸ ì§€ì‹ë„ ì •ë¦¬í•´ì„œ ì˜¬ë ¤ì£¼ê³  í”¼ì–´ ì„¸ì…˜ì— ë‚˜ì˜¤ëŠ” ì§ˆë¬¸ë„ ì˜ ì•Œë ¤ì£¼ê³  ê³„ì‹ ë°, ìš°ë¦¬ ì¡°ì— ì»´ê³µë§Œì´ ì•„ë‹ˆë¼ í†µê³„í•™ê³¼ ìˆ˜í•™ê³¼ ë“± ì—¬ëŸ¬ í™˜ê²½ì˜ ì‚¬ëŒë“¤ì´ ëª¨ì˜€ê¸° ë•Œë¬¸ì— ë” ë„ì›€ ë°›ê¸° ì¢‹ìŒì„ ëŠê¼ˆë‹¤. ì™œ ìš”ì¦˜ íšŒì‚¬ë“¤ë„ ë¹„ì „ê³µì ì¶œì‹ ì„ ë½‘ëŠ”ì§€ ì•Œ ê²ƒ ê°™ì•˜ë‹¤. ê¸°ë³¸ ì‹¤ë ¥ë§Œ ìˆë‹¤ë©´ ë‹¤ì±„ë¡œì›€ì´ ë§Œë“¤ì–´ë‚´ëŠ” ì¡°í™”ê°€ ë” ì¢‹ê¸° ë•Œë¬¸ì´ ì•„ë‹ê¹Œ?