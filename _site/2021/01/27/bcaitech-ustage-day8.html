<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <!--Favicon-->
  <link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.9.0/css/all.css"
    integrity="sha384-i1LQnF23gykqWXg6jxC2ZbCbUMxyw5gLZY6UiUS98LYV5unm8GWmfkIS6jqJfb4E" crossorigin="anonymous">

  <!-- Spoqa Han Sans -->
  <link href='//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSans-kr.css' rel='stylesheet' type='text/css'>

  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css">

  <!-- OG Tag -->
  
  <meta name="title" content="Heeseok Jeong-Ustage Day 8" />
  <meta name="author" content="Heeseok Jeong" />
  <meta name="keywords" content="BoostCamp AI Tech" />
  <meta name="description" content="Pandas|딥러닝 원리 이해" />
  <meta name="robots" content="index,follow" />

  <meta property="og:title" content="Heeseok Jeong-Ustage Day 8" />
  <meta property="og:description" content="Pandas|딥러닝 원리 이해" />
  <meta property="og:type" content="website, blog" />
  <meta property="og:image"
    content="http://localhost:4000/assets/img/smile.png" />
  <meta property="og:site_name" content="Heeseok Jeong" />
  <meta property="og:url" content="http://localhost:4000/2021/01/27/bcaitech-ustage-day8.html" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Heeseok Jeong-Ustage Day 8" />
  <meta name="twitter:description" content="Pandas|딥러닝 원리 이해" />
  <meta name="twitter:image"
    content="http://localhost:4000/assets/img/smile.png" />

  <title>Heeseok Jeong-Ustage Day 8</title>
</head>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        TeX: {
          equationNumbers: {
            autoNumber: "AMS"
          }
        },
        tex2jax: {
        inlineMath: [ ['$', '$'] ],
        displayMath: [ ['$$', '$$'] ],
        processEscapes: true,
      }
    });
    MathJax.Hub.Register.MessageHook("Math Processing Error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    MathJax.Hub.Register.MessageHook("TeX Jax - parse error",function (message) {
          alert("Math Processing Error: "+message[1]);
        });
    </script>
    <script type="text/javascript" async
      src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>


<body>
  <div class="container">
    

<header>
  <nav>
    <ul>
      
      <!-- others -->
      <a href="http://localhost:4000">
        <li class="current btn-nav">Blog</li>
      </a>
      <a href="http://localhost:4000/tags">
        <li class="btn-nav">Tags</li>
      </a>
      <a href="http://localhost:4000/portfolio">
        <li class="btn-nav">Portfolio</li>
      </a>
      
    </ul>
  </nav>
</header>
<div id="post">
  <section class="post-header">
    <h1 class="title">Ustage Day 8</h1>
    <p class="subtitle">Pandas|딥러닝 원리 이해</p>
    <p class="meta">
      January 27, 2021
    </p>
  </section>
  <section class="post-content">
    <h1 id="목차">목차</h1>

<p><br /></p>

<ul>
  <li><a href="#pandas">Pandas</a></li>
  <li><a href="#딥러닝-학습방법-이해하기">딥러닝 학습방법 이해하기</a></li>
  <li><a href="#피어-세션">피어 세션</a></li>
  <li><a href="#today-i-felt">Today I Felt</a></li>
</ul>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="pandas">Pandas</h1>

<p><br /></p>

<ul>
  <li>panel data</li>
  <li>구조화된 데이터의 처리를 지원하는 파이썬 라이브러리</li>
  <li>고성능 계산 라이브러리 numpy 와 통합하여, 강력한 스프레드시트 처리 기능 제공</li>
  <li>인덱싱, 연산용 함수, 전처리 함수 등 제공, 데이터 처리 및 통계 분석을 위해 사용</li>
  <li>테이블, 어트리뷰트(피쳐), 인스턴스(튜플), 피쳐벡터(세로열), 데이터(하나의값)가 있음</li>
  <li>이미지 같은거 처리하는 도구가 아님</li>
</ul>

<h3 id="설치">설치</h3>

<ul>
  <li>콘다 가상환경에서 conda install pandas 로 설치</li>
</ul>

<h3 id="실행">실행</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="n">data_url</span> <span class="o">=</span> <span class="s">'https://archive.ics.uci.edu/ml/machine-learning-databases/housing/housing.data'</span>
<span class="n">df_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s">'\s+'</span><span class="p">,</span> <span class="n">header</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span> <span class="c1"># sep 은 정규식
</span><span class="n">df_data</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<ul>
  <li>결과</li>
</ul>

<p><img src="/assets/img/ustage_day8/ustage_day8_1.png" alt="ustage_day8_1" /></p>

<h2 id="기본-사용">기본 사용</h2>

<h2 id="series">series</h2>

<ul>
  <li>(DataFrame : Data Table 전체를 포함하는 Object)</li>
  <li>Series : DataFrame 중 하나의 Column 에 해당하는 데이터 모음 Object</li>
  <li>인덱스, 값, 데이터 타입이 나옴, numpy.ndarray 타입</li>
  <li>딕트도 넣을 수 있음 → 자동으로 키는 인덱스, 밸류는 값이 됨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">list_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">example_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">list_data</span><span class="p">)</span>
<span class="n">example_obj</span>
<span class="s">'''
0    1
1    2
2    3
3    4
4    5
dtype: int64
'''</span>

<span class="n">dict_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'a'</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'b'</span> <span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">example_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dict_data</span><span class="p">)</span>
<span class="n">example_obj</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"number"</span>
<span class="n">example_obj</span><span class="p">.</span><span class="n">index</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"alphabet"</span>
<span class="n">example_obj</span>

<span class="s">'''
alphabet
a    1
b    2
Name: number, dtype: int64
'''</span>

<span class="n">example_obj</span><span class="p">.</span><span class="n">index</span>
<span class="c1"># Index(['a', 'b'], dtype='object', name='alphabet')
</span>
<span class="c1"># index 값 기준으로 series 생성
</span><span class="n">dict_data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'a'</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s">'b'</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s">'c'</span> <span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s">'d'</span> <span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s">'e'</span> <span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="s">'a'</span><span class="p">,</span> <span class="s">'b'</span><span class="p">,</span> <span class="s">'c'</span><span class="p">,</span> <span class="s">'d'</span><span class="p">,</span> <span class="s">'e'</span><span class="p">,</span> <span class="s">'f'</span><span class="p">]</span>
<span class="n">series_obj</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">dict_data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">indexes</span><span class="p">)</span>
<span class="n">series_obj</span>
<span class="s">'''
a    1.0
b    2.0
c    3.0
d    4.0
e    5.0
f    NaN
dtype: float64
'''</span>
</code></pre></div></div>

<h2 id="dataframe">DataFrame</h2>

<ul>
  <li>시리즈 데이터들의 모임, 테이블이기도 함, 기본 2차원, 주로 csv 나 엑셀 형태로 불러냄</li>
  <li>컬럼마다 데이터 타입이 다를 수 있음</li>
  <li>인덱스와 컬럼으로 접근 가능</li>
  <li>df[“first_name”] 와 df.first_name 은 같음. fist_name 컬럼 불러옴</li>
  <li>인덱싱
    <ul>
      <li>loc - index 이름</li>
      <li>iloc - index 번호</li>
    </ul>

    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1"># 값 중 3 이 나올때까지 추출
</span>  <span class="n">df</span><span class="p">.</span><span class="n">loc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
  <span class="s">'''
  first_name	last_name	age	city
  0	Jason	Miller	42	San Francisco
  1	Molly	Jacobson	52	Baltimore
  2	Tina	Ali	36	Miami
  3	Jake	Milner	24	Douglas
  '''</span>

  <span class="c1"># 인덱스 3 전까지 추출
</span>  <span class="n">df</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
  <span class="s">'''
  first_name	last_name	age	city
  0	Jason	Miller	42	San Francisco
  1	Molly	Jacobson	52	Baltimore
  2	Tina	Ali	36	Miami
  '''</span>
</code></pre></div>    </div>
  </li>
  <li>자세한 코드는 <a href="https://github.com/BoostcampAITech/lecture-note-python-basics-for-ai/blob/main/codes/pandas/%231/4_pandas_dataframe.ipynb">DataFrame</a> 에 있습니다.</li>
  <li>boolean index 로 값 설정 가능</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">.</span><span class="n">debt</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">40</span>
<span class="n">df</span>
<span class="s">'''
first_name	last_name	age	city	debt
0	Jason	Miller	42	San Francisco	True
1	Molly	Jacobson	52	Baltimore	True
2	Tina	Ali	36	Miami	False
3	Jake	Milner	24	Douglas	False
4	Amy	Cooze	73	Boston	True
'''</span>
</code></pre></div></div>

<ul>
  <li>to_csv() : csv 형태로 변환, 파라미터 조절하면 저장도 가능</li>
  <li>컬럼 삭제
    <ul>
      <li>del df[“debt”] → 아예 테이블에서 삭제해버림</li>
      <li>df.drop(“debt”, axis=1) → 리턴해주고 원본은 안바뀜</li>
    </ul>
  </li>
</ul>

<h3 id="selection--drop">Selection &amp; Drop</h3>

<h5 id="selection--시리즈컬럼-불러오는-작업">selection : 시리즈(컬럼) 불러오는 작업</h5>

<ul>
  <li>엑셀 파일 다룰 때 <code class="language-plaintext highlighter-rouge">!conda install --y xlrd</code> 로 xlrd 설치</li>
  <li>컬럼명으로 뽑기
    <ul>
      <li>df[“a”] → Series 로 뽑힘, df[[“a”]] → DataFrame으로 뽑힘</li>
    </ul>
  </li>
  <li>인덱스로 뽑기
    <ul>
      <li>df[“account”][:3] → 어카운트 시리즈의 0, 1, 2 인덱스 지닌 값들 뽑음</li>
      <li>인덱스가 영어인데 숫자로 부르면 안 뽑아짐</li>
    </ul>
  </li>
  <li>fancy index, boolean index 가능</li>
  <li>인덱스값 설정, df.index = df[“account”]</li>
  <li>데이터 뽑는 방식 (중요)
    <ol>
      <li>
        <dl>
          <dt>df[[“name”, “street][:2] # 컬럼과 인덱스 네임</dt>
          <dd>해당 시리즈의 인스턴스 2개 가져옴</dd>
        </dl>
      </li>
      <li>
        <dl>
          <dt>df.loc[[211829, 320563], [“name”, “street”] # row 네임, col 네임</dt>
          <dd>해당 인덱스에 해당 컬럼 값 가져옴</dd>
        </dl>
      </li>
      <li>
        <dl>
          <dt>df.iloc[:2, :2] # 로우 개수, 컬럼 개수</dt>
          <dd>2개 컬럼의 2개 인스턴스 가져옴</dd>
        </dl>
      </li>
    </ol>
  </li>
</ul>

<p>→ 셋 다 같은 결과</p>

<ul>
  <li>reset_index() : 인덱스 값 초기화 (0, 1, 2 …), 원본 안바뀜
    <ul>
      <li>프로퍼티로 inplace=Ture 하면 원본에 적용</li>
      <li>기본적으로 데이터프레임 원본 안건드릴려고 함</li>
    </ul>
  </li>
  <li>boolean index 로 셀렉션 가능</li>
</ul>

<h5 id="drop--삭제하는-작업">drop : 삭제하는 작업</h5>

<ul>
  <li>df.drop(“city”, axis=1) # city 컬럼(axis=1) 삭제, 원본 안바뀜</li>
</ul>

<h3 id="series-operation">Series operation</h3>

<ul>
  <li>s1.add(s2) : s1 과 s2 합치는데 겹치는 인덱스가 없는 경우 NaN 으로 채워짐
→ s1 + s2 와 동일</li>
</ul>

<h3 id="dataframe-operation">DataFrame operation</h3>

<ul>
  <li>
    <p>df1.add(df2, fill_value=0) : 두 데이터 프레임 합치는데 (인덱스 + 컬럼 전부) 안 겹치는 공간은 NaN 으로 채움. fill_value 를 설정하면 NaN 대신 그 값으로 채움</p>

    <p>→ df1 + df2 와 기본적으로 동일</p>
  </li>
</ul>

<h3 id="series--dataframe">Series + DataFrame</h3>

<ul>
  <li>데이터프레임의 컬럼과 시리즈의 인덱스가 같으면 브로드캐스팅 연산됨</li>
  <li>add 에서 axis 를 설정하면 broadcasting 실행됨</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s">"abcd"</span><span class="p">))</span>
<span class="n">df</span>
<span class="s">'''
a	b	c	d
0	0	1	2	3
1	4	5	6	7
2	8	9	10	11
3	12	13	14	15
'''</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s">"abcd"</span><span class="p">))</span>
<span class="n">s</span>
<span class="s">'''
a    10
b    11
c    12
d    13
dtype: int64
'''</span>

<span class="n">df</span> <span class="o">+</span> <span class="n">s</span>
<span class="s">'''
a	b	c	d
0	10	12	14	16
1	14	16	18	20
2	18	20	22	24
3	22	24	26	28
'''</span>

<span class="n">s2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">14</span><span class="p">))</span>
<span class="n">s2</span>
<span class="s">'''
0    10
1    11
2    12
3    13
dtype: int64
'''</span>

<span class="c1"># 시리즈의 인덱스가 없어서 옆으로 붙임, NaN으로 전부 채워짐
</span><span class="n">df</span> <span class="o">+</span> <span class="n">s2</span> <span class="c1"># == df.add(s2, axis=1)
</span><span class="s">'''
a	b	c	d	0	1	2	3
0	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
1	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
2	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
3	NaN	NaN	NaN	NaN	NaN	NaN	NaN	NaN
'''</span>

<span class="n">df</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">s2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="s">'''
a	b	c	d
0	10	11	12	13
1	15	16	17	18
2	20	21	22	23
3	25	26	27	28
'''</span>
</code></pre></div></div>

<h2 id="lambda-map-apply">lambda, map, apply</h2>

<h3 id="map-for-siries">map for siries</h3>

<ul>
  <li>판다스의 시리즈 다입의 데이터에도 맵 가능</li>
  <li>function 대신 dict, sequence 형 자료등으로 대체 가능</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">s1</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="n">head</span><span class="p">()</span>
<span class="s">'''
0     0
1     1
2     4
3     9
4    16
dtype: int64
'''</span>

<span class="c1"># dict 타입 적용
</span><span class="n">z</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s">'a'</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s">'b'</span><span class="p">,</span> <span class="mi">3</span> <span class="p">:</span> <span class="s">'c'</span><span class="p">}</span>
<span class="n">s1</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">z</span><span class="p">).</span><span class="n">head</span><span class="p">()</span>
<span class="s">'''
0    NaN
1      a
2      b
3      c
4    NaN
dtype: object
'''</span>

<span class="c1"># DF 타입 적용
</span><span class="n">s2</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">s2</span><span class="p">.</span><span class="nb">map</span><span class="p">(</span><span class="n">s2</span><span class="p">).</span><span class="n">head</span><span class="p">()</span>
<span class="s">'''
0   NaN
1   NaN
2   NaN
3   NaN
4   NaN
dtype: float64
'''</span>
</code></pre></div></div>

<ul>
  <li>replace 처럼 딕트를 써서 데이터프레임의 어떤 값을 키와 매칭하여 밸류로 바꿔줄 수 있음</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df</span><span class="p">[</span><span class="s">"sex_code"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="nb">map</span><span class="p">({</span><span class="s">"male"</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"female"</span> <span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">earn</span>	<span class="n">height</span>	<span class="n">sex</span>	<span class="n">race</span>	<span class="n">ed</span>	<span class="n">age</span>	<span class="n">sex_code</span>
<span class="mi">0</span>	<span class="mf">79571.299011</span>	<span class="mf">73.89</span>	<span class="n">male</span>	<span class="n">white</span>	<span class="mi">16</span>	<span class="mi">49</span>	<span class="mi">0</span>
<span class="mi">1</span>	<span class="mf">96396.988643</span>	<span class="mf">66.23</span>	<span class="n">female</span>	<span class="n">white</span>	<span class="mi">16</span>	<span class="mi">62</span>	<span class="mi">1</span>
<span class="mi">2</span>	<span class="mf">48710.666947</span>	<span class="mf">63.77</span>	<span class="n">female</span>	<span class="n">white</span>	<span class="mi">16</span>	<span class="mi">33</span>	<span class="mi">1</span>
<span class="mi">3</span>	<span class="mf">80478.096153</span>	<span class="mf">63.22</span>	<span class="n">female</span>	<span class="n">other</span>	<span class="mi">16</span>	<span class="mi">95</span>	<span class="mi">1</span>
<span class="mi">4</span>	<span class="mf">82089.345498</span>	<span class="mf">63.08</span>	<span class="n">female</span>	<span class="n">white</span>	<span class="mi">17</span>	<span class="mi">43</span>	<span class="mi">1</span>

<span class="n">df</span><span class="p">.</span><span class="n">sex</span><span class="p">.</span><span class="n">replace</span><span class="p">({</span><span class="s">"male"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"female"</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">df</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">earn</span>	<span class="n">height</span>	<span class="n">sex</span>	<span class="n">race</span>	<span class="n">ed</span>	<span class="n">age</span>	<span class="n">sex_code</span>
<span class="mi">0</span>	<span class="mf">79571.299011</span>	<span class="mf">73.89</span>	<span class="mi">0</span>	<span class="n">white</span>	<span class="mi">16</span>	<span class="mi">49</span>	<span class="mi">0</span>
<span class="mi">1</span>	<span class="mf">96396.988643</span>	<span class="mf">66.23</span>	<span class="mi">1</span>	<span class="n">white</span>	<span class="mi">16</span>	<span class="mi">62</span>	<span class="mi">1</span>
<span class="mi">2</span>	<span class="mf">48710.666947</span>	<span class="mf">63.77</span>	<span class="mi">1</span>	<span class="n">white</span>	<span class="mi">16</span>	<span class="mi">33</span>	<span class="mi">1</span>
<span class="mi">3</span>	<span class="mf">80478.096153</span>	<span class="mf">63.22</span>	<span class="mi">1</span>	<span class="n">other</span>	<span class="mi">16</span>	<span class="mi">95</span>	<span class="mi">1</span>
<span class="mi">4</span>	<span class="mf">82089.345498</span>	<span class="mf">63.08</span>	<span class="mi">1</span>	<span class="n">white</span>	<span class="mi">17</span>	<span class="mi">43</span>	<span class="mi">1</span>
</code></pre></div></div>

<h3 id="apply">apply</h3>

<ul>
  <li>맵과 다르게 시리즈 전체에 해당 함수를 적용, 시리즈 단위로 적용시키면 맵과 같은 효과</li>
  <li>입력 값을 시리즈 데이터로 받아 핸들링 가능</li>
  <li>내장 연산 함수 (sum, mean, std 등) 를 사용하는 것과 같은 효과</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 셋 다 똑같음
# 함수 정의 후 어플라이
</span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">df_info</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="c1"># 내장 함수 어플라이
</span><span class="n">df_info</span><span class="p">.</span><span class="nb">apply</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">mean</span><span class="p">)</span>

<span class="c1"># 내장 함수 사용
</span><span class="n">df_info</span><span class="p">.</span><span class="n">mean</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="pandas-built-in-function">pandas built-in function</h2>

<h3 id="describe">describe</h3>

<ul>
  <li>가지고 있는 값 중 Numeric type (숫자들) 의 요약 정보를 보여줌</li>
</ul>

<h3 id="unique">unique</h3>

<ul>
  <li>시리즈 데이터의 유일한 값을 리스트로 반환함</li>
</ul>

<h3 id="sum">sum</h3>

<ul>
  <li>축을 기준으로 연산 진행</li>
  <li>sub, mean, min …</li>
</ul>

<h3 id="isnull">isnull</h3>

<ul>
  <li>테이블에서 값이 NaN(null) 인 데이터는 True 로 아니면 False 로 만들어서 DF 반환</li>
  <li>isnull().sum() 하면 컬럼에 관해서 널값 개수 세어 줌</li>
</ul>

<h3 id="sort_values">sort_values</h3>

<ul>
  <li>컬럼 값을 기준으로 정렬해줌</li>
  <li>df.sort_values([“age”, “earn”], ascending=True).head()</li>
</ul>

<h3 id="corr-conv-corrwith">corr, conv, corrwith</h3>

<ul>
  <li>corr : 상관계수 구해줌, 아규먼트로 시리즈 넣어도 되고 안넣으면 테이블 전체로 구해줌</li>
  <li>cov : 공분산 구해줌</li>
  <li>corrwith : 테이블과 아규먼트의 상관계수 구해줌</li>
  <li>위 작업들 할 때 스트링 값이면 난감하므로 라벨링 (0, 1) 등 으로 바꿔서 사용하면 용이</li>
</ul>

<h3 id="여러개-컬럼-다룰-때">여러개 컬럼 다룰 때</h3>

<ul>
  <li>컬럼에 대한 리스틀 만들어서 수행</li>
</ul>

<h3 id="한-번에-볼-수-있는-양-조절">한 번에 볼 수 있는 양 조절</h3>

<ul>
  <li>pd.options.display.max_rows = 100</li>
</ul>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="딥러닝-학습방법-이해하기">딥러닝 학습방법 이해하기</h1>

<p><br /></p>

<ul>
  <li>신경망은 기본적으로 비선형 모델, 하지만 뜯어보면 선형모델과 비선형 함수들의 결합으로 이루어짐</li>
  <li>비선형 모델을 어떻게 선형 모델로 만드는지 알 것</li>
</ul>

<h3 id="선형-모델">선형 모델</h3>

<ul>
  <li>O(nxp) = X(nxd)W(dxp) + b(nxp)
    <ul>
      <li>X : 데이터 행렬, W : X 각 데이터를 다른 공간으로 보내주는 가중치 행렬</li>
      <li>b 는 각 행들이 같은 값을 지님 (y 절편 벡터)</li>
    </ul>
  </li>
  <li>아래 그림과 같이 각 데이터 x 는 각 결과 o 에 대해 화살표로 연결됨
→ 화살표는 x 를 o 로 연결하는 W (웨이트) 라고 생각하면 됨
→ d 개가 p 개로 가므로 W 는 dxp 개가 있음
    <ul>
      <li>W 는 d 개의 변수로 p 개의 선형모델을 만들어서 p 개의 잠재변수를 설명하는 모델</li>
    </ul>
  </li>
</ul>

<p><a href=""></a></p>

<h2 id="softmax">Softmax</h2>

<ul>
  <li>분류 문제에서 모델 (비선형 모델) 의 출력을 확률로 해석할 수 있게 변환해주는 연산, 데이터가 어떤 클래스에 속하는지 분류</li>
  <li>분류 문제에서 선형모델과 소프트맥스 함수 결합하여 예측</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">vec</span><span class="p">):</span>
	<span class="n">denumerator</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">vec</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">max</span><span class="p">(</span><span class="n">vec</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
	<span class="n">numerator</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">denumerator</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
	<span class="n">val</span> <span class="o">=</span> <span class="n">denumerator</span> <span class="o">/</span> <span class="n">numerator</span>
	<span class="k">return</span> <span class="n">val</span>
</code></pre></div></div>

<ul>
  <li>학습에는 소프트맥스가 필요하지만, 추론(실전) 할 때는 소프트맥스 말고 one_hot 벡터로 (최대값을 가진 주소만 1 로 출력하는 연산) 사용</li>
</ul>

<h2 id="신경망">신경망</h2>

<ul>
  <li>선형모델과 활성함수를 합성한 함수 = 히든벡터</li>
  <li>활성함수와 소프트맥스 차이 : 소프트맥스는 출력물 모든 값 고려해서 출력 - 벡터를 받음, 활성함수는 하나의 주소만 고려해서 출력 - 실수값 1 개만 받음</li>
</ul>

<h3 id="활성함수">활성함수</h3>

<ul>
  <li>실수를 받아서 실수를 반환</li>
  <li>활성함수를 쓰지 않으면 선형모델임, 활성함수 써야 비선형으로 바뀜</li>
  <li>시그모이드나 tanh 를 예전에 썼지만, 이제는 <strong>ReLU</strong> 함수 사용</li>
  <li>z 행렬의 모든 원소에 활성함수 씌움 (실수를 받기 때문에)</li>
</ul>

<h3 id="신경망-수식">신경망 수식</h3>

<p><img src="/assets/img/ustage_day8/ustage_day8_2.png" alt="ustage_day8_2" /></p>

<ul>
  <li>2-layer 신경망 : x → z 에서 W1, 활성함수(시그마)(z) → o 에서 W2 사용</li>
  <li>
    <p>위 구조를 반복적으로 사용하면 multi-layer perceptron, MLP 신경망이 됨</p>

    <p><img src="/assets/img/ustage_day8/ustage_day8_3.png" alt="ustage_day8_3" /></p>
  </li>
  <li>위 작업은 Forward propagation!</li>
  <li>왜 층을 여러개 쌓나요?
    <ul>
      <li>층이 깊을수록 목적함수를 근사하는데 필요한 뉴련(노드) 의 숫자가 훨씬 빨리 줄어들어 더 효율적인 학습 가능 → 층이 얇으면 넓은 신경망이 돼야함</li>
      <li>층이 깊으면 복잡한 함수 표현은 가능하지만, 최적화는 더 어려워짐 (나중에 convolution 에서 residual 배울 것)</li>
    </ul>
  </li>
</ul>

<h2 id="딥러닝-학습원리-역전파-알고리즘">딥러닝 학습원리: 역전파 알고리즘</h2>

<ul>
  <li>순전파는 선형모델에 활성함수 썼었음</li>
  <li>역전파는 학습에서 경사하강법을 써야하는데 이 때 가중치를 업데이트함에 있어 합성함수를 다뤄서 최초의 가중치를 구할 수 있게 해줌</li>
  <li>윗 층의 그레디언트를 구하여 다음층, 다음층 역순으로 전달함</li>
</ul>

<p><img src="/assets/img/ustage_day8/ustage_day8_4.png" alt="ustage_day8_4" /></p>

<h3 id="역전파-원리-이해하기">역전파 원리 이해하기</h3>

<ul>
  <li>합성함수 미분법인 연쇄법칙(체인룰) 기반 자동미분 사용</li>
</ul>

<p><img src="/assets/img/ustage_day8/ustage_day8_5.png" alt="ustage_day8_5" /></p>

<p>→ 모든 변수에 대해 편미분을 저장해야함 → 순전파보다 메모리 많이 사용</p>

<ul>
  <li>예제</li>
</ul>

<p><img src="/assets/img/ustage_day8/ustage_day8_6.png" alt="ustage_day8_6" /></p>

<ul>
  <li>파란색 : 순전파, 빨간색 : 역전파</li>
  <li>역전파 결과값부터해서 W1까지 연쇄법칙 사용</li>
</ul>

<h3 id="further-question">Further Question</h3>

<ol>
  <li>분류 문제에서 softmax 함수가 사용되는 이유가 뭘까요?</li>
  <li>softmax 함수의 결과값을 분류 모델의 학습에 어떤식으로 사용할 수 있을까요?</li>
</ol>

<h3 id="교수님-말씀">교수님 말씀</h3>

<ul>
  <li>딥러닝 원리 (여러 층의 선형모델과 활성함수에 대한 함성함수, 합성함수의 그래디언트 계산을 위해 연쇄법칙 적용한 역전파 알고리즘 사용) 이해할 것</li>
</ul>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="피어-세션">피어 세션</h1>

<p><br /></p>

<h2 id="세미나">세미나</h2>

<h3 id="후미님---마르하바">후미님 - 마르하바!</h3>

<ul>
  <li>파병을 다녀옴 (동명부대 레바논, 베이루트)</li>
  <li>8개월</li>
</ul>

<h3 id="원딜님">원딜님</h3>

<ul>
  <li>기초 통계 (순한맛)
    <ul>
      <li>확률
        <ul>
          <li>어떤 시행을 반복할 때 N 번 시행에서 사건 A 가 발생한 횟수를 n(A) 라 하면 확률은 무한히 발생할 때 P(A) = n(A)/N</li>
          <li>빈도론 학파</li>
          <li>베이지안 학파</li>
        </ul>
      </li>
      <li>확률의 공리 3 조건 무조건 만족해야 확률</li>
      <li>조건부 확률
        <blockquote>
          <table>
            <tbody>
              <tr>
                <td>P(A</td>
                <td>B) = P(A교B)/P(B)</td>
              </tr>
            </tbody>
          </table>
        </blockquote>
      </li>
      <li>확률 변수 : 표본공간의 사건 또는 원소를 실수값으로 변환하는 함수
        <ul>
          <li>이산형 변수</li>
          <li>연속형 변수</li>
        </ul>
      </li>
      <li>이산분포
        <ul>
          <li>베르누이 분포</li>
          <li>포아손 분포 등</li>
        </ul>
      </li>
      <li>연속분포</li>
      <li>가능도 함수 : 간단하게는 확률밀도함수랑 비슷, 가능도함수는 확률함수가 아님</li>
    </ul>
  </li>
</ul>

<h2 id="피어세션-피드백">피어세션 피드백</h2>

<ul>
  <li>이슈는 퍼블릭 레포지토리, 코드 리뷰는 프라이빗 레포지토리</li>
  <li>개인 발표 자료 등은 구글드라이브에 자율적으로 올리기로</li>
</ul>

<p><br /></p>

<hr />

<p><br /></p>

<h1 id="today-i-felt">Today I Felt</h1>

<p><br /></p>

<h2 id="꿈틀꿈틀">꿈틀꿈틀</h2>

<p>오늘은 아니지만,, 어제 행렬의 미분과 목적식을 이용한 경사하강법에 대한 개념이 꼬여 밥먹는 시간 빼고 밤까지 계속 공부했다 (끈기 점수 +1). 한 번 꼬이니까 더이상 진전이 없어 다시 월요일 강의부터 공부했고 그 끝에 이해할 수 있었다. 그리고 안 까먹기 위해 자기 전에 누워서 다시 상기했다. 비록 느리게 걸어가도 이 마음가짐으로 캠프가 끝나고도 계속 발전하는 사람이 되고싶다.</p>

  </section>
</div>

<div id="top" class="top-btn" onclick="moveTop()">
  <i class="fas fa-chevron-up"></i>
</div>

<!-- Disqus -->

<div id="comments">
  <div class="border">
    <div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname = 'heeseok-jeong';
  (function () {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript></noscript>
  </div>
</div>


<!-- Footer -->
<footer>
  <div class="footer">
    Copyright © 2019
    <a href="https://github.com/NAYE0NG">Nayeong Kim</a>.
    Powered by Jekyll with
    <a href="https://github.com/naye0ng/Grape-Theme">Grape Theme</a>.
  </div>
</footer>


<script>
  var lastScrollTop = 0;
  window.onscroll = function () {
    var st = document.body.scrollTop || document.documentElement.scrollTop;
    if (st > 250) {
      document.getElementById("top").style.display = "block"
      if (st > lastScrollTop) {
        document.getElementById("top").style.opacity = 0
      } else {
        document.getElementById("top").style.opacity = 1
      }
    } else {
      document.getElementById("top").style.opacity = 0
      if (st > lastScrollTop) {
        document.getElementById("top").style.display = "none"
      }
    }
    lastScrollTop = st <= 0 ? 0 : st;
  }
  function moveTop() {
    document.body.scrollTop = 0
    document.documentElement.scrollTop = 0
  }
</script>
  </div>
</body>

</html>